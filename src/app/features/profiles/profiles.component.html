<app-header headerText="Profiles" [pageType]="pageTypes.PROFILES"></app-header>

<div class="toggle-section">
  <mat-slide-toggle
    color="primary"
    (change)="profileService.filterWithFriends()"
    [checked]="profileService.showFriends"
  >
    <span class="ml-10px fw-500">Show Friends Only</span>
  </mat-slide-toggle>
</div>

<div
  class="profiles-section"
  [ngStyle]="{
    'justify-content':
      profileService.loadingProfiles || !profileService.profiles.length
        ? 'center'
        : ''
  }"
>
  @if (profileService.loadingProfiles) {
  <div class="flex justify-content-center align-items-center gap-20px">
    <strong>
      Loading {{ profileService.showFriends ? "Friends" : "Profiles" }} ...
    </strong>
    <mat-spinner color="h-35px w-35px"></mat-spinner>
  </div>
  } @else { @if(profileService.profiles.length) {
  <div class="mt-90px">
    @for (profile of profileService.profiles; track profile) {
    <div class="profile-section">
      @if (profile.photoURL) {
      <div
        class="profile-photo"
        [ngStyle]="{
          'background-image': 'url(' + profile.photoURL + ')'
        }"
      ></div>
      } @else {
      <div class="profile-plc">
        {{ profile.displayName?.substring(0, 2)?.toUpperCase() }}
      </div>
      }

      <div class="profile-dn" routerLink="/profile/{{ profile.uid }}">
        {{ profile.firstName }} {{ profile.lastName }}

        @if (profile.uid === appService.userId) {
        <strong> (You) </strong>
        }
      </div>
    </div>
    }
  </div>
  } @else {
  <div>
    <strong>
      {{
        profileService.showFriends ? "No friends found" : "No profiles found"
      }}
    </strong>
  </div>
  } }
</div>
