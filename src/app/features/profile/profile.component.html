<app-header headerText="Profile" [pageType]="pageTypes.PROFILE"></app-header>

@if (profileService.loadingProfile) {
<app-loader label="Loading Profile" [height]="35" [width]="35"></app-loader>
} @else {
<!-- Cover photo section with Profile photo -->
<app-cover-photo-section></app-cover-photo-section>

<!-- Show Name with Username -->
<app-name-section></app-name-section>

<div class="profile-info-with-feeds">
  <div>
    <div>
      <strong> Email Address </strong>
    </div>
    <div>
      {{ profileService.profile.email }} @if
      (profileService.profile.isEmailVerified) {
      <span> (Verified) </span>
      }
    </div>
    @if (!profileService.profile.isEmailVerified && profileService.isMyProfile)
    {
    <div class="mt-5px">
      Your email is not verified yet.
      <div class="mt-10px">
        <button
          mat-flat-button
          color="primary"
          class="h-30px w-115px text-center"
          (click)="authService.sendEmailVerification()"
          [disabled]="authService.sendingEmail"
        >
          @if (authService.sendingEmail) {
          <mat-spinner class="ml-10px h-20px w-20px"></mat-spinner>
          } @else { Verify now }
        </button>
      </div>
    </div>
    }
  </div>

  <div>
    <div>
      <strong> Gender </strong>
    </div>
    <div>
      {{ profileService.profile.genderId == 1 ? "Male" : "Female" }}
    </div>
  </div>

  <div>
    <div [class.mb-8px]="profileService.isMyProfile">
      <strong> Birthday </strong>
    </div>

    @if (profileService.profile.dob && !profileService.isEditable.birthday) {
    <div class="flex align-items-center gap-10px">
      <span>
        {{ profileService.profile.dob | date : "MMMM d, y" }}
      </span>

      @if (!profileService.isEditable.birthday && profileService.isMyProfile) {
      <mat-icon
        class="pointer"
        (click)="profileService.prepareBirthdayForm()"
        [class.disabled-icon]="
          profileService.isEditable.birthday ||
          profileService.isEditable.privacy
        "
        >edit</mat-icon
      >
      }
    </div>
    } @else { @if (!profileService.profile.dob && profileService.isMyProfile) {
    <div>You haven't updated your birthday.</div>
    <div class="mt-10px mb-25px">
      <button
        mat-flat-button
        class="h-30px"
        color="primary"
        (click)="profileService.prepareBirthdayForm()"
      >
        Click
      </button>
      to update.
    </div>
    } @if (profileService.isEditable.birthday && profileService.isMyProfile) {
    <div
      class="flex justify-content-center align-items-center mt-10px gap-20px"
    >
      <app-datepicker [field]="profileService.field"></app-datepicker>
      <div class="close-icon">
        <mat-icon
          size="small"
          class="pointer"
          (click)="profileService.isEditable.birthday = false"
          >close</mat-icon
        >
      </div>
    </div>
    } @else {
    <mat-icon
      class="pointer"
      (click)="profileService.isEditable.birthday = false"
      >close</mat-icon
    >
    } }
  </div>
</div>
}
